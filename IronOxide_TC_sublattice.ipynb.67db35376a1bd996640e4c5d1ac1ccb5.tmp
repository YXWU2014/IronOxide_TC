# Merge results from different processes
list_of_conditions = [res[0] for res in FullEquil_results]
list_np_CORUNDUM = [res[1] for res in FullEquil_results]
list_np_SPINEL = [res[2] for res in FullEquil_results]
list_np_HALITE = [res[3] for res in FullEquil_results]
list_np_BCC_A2 = [res[4] for res in FullEquil_results]

# print(len(list_of_conditions))

# Flattening the lists
list_of_conditions = [
    item for sublist in list_of_conditions for item in sublist]
list_np_CORUNDUM = [item for sublist in list_np_CORUNDUM for item in sublist]
list_np_SPINEL = [item for sublist in list_np_SPINEL for item in sublist]
list_np_HALITE = [item for sublist in list_np_HALITE for item in sublist]
list_np_BCC_A2 = [item for sublist in list_np_BCC_A2 for item in sublist]

# print(len(list_of_conditions))

# list_np_FCC_L12_merge = [max(a, b, c) for a, b, c in zip(
#     list_np_FCC_L12, list_np_FCC_L12_1, list_np_FCC_L12_2)]

df_FullEquil = pd.DataFrame(columns=['lnacr_o', 'T', 'np(CORUNDUM)',
                                     'np(SPINEL)', 'np(HALITE)', 'np(BCC_A2)'])

# Convert conditions and results to DataFrame
df_FullEquil = pd.DataFrame({
    'lnacr_o': [dict(conditions)['lnacr(o)'] for conditions in list_of_conditions],
    'T': [dict(conditions)['T'] for conditions in list_of_conditions],
    'np(CORUNDUM)': list_np_CORUNDUM,
    'np(SPINEL)': list_np_SPINEL,
    'np(HALITE)': list_np_HALITE,
    'np(BCC_A2)': list_np_BCC_A2,
})

df_FullEquil.to_excel(os.path.join(current_directory,
                                   "tc_df_FullEquil_check.xlsx"), index=False)

display(df_FullEquil.head(3), df_FullEquil.shape)