# Filter the dataframe for rows where T is 573.15
filtered_df_FullEquil = df_FullEquil[df_FullEquil['T'] == 573.15]
filtered_df_FullEquil.to_excel(os.path.join(current_directory,
                                            "tc_df_FullEquil_check_filter.xlsx"), index=False)

plt.figure(figsize=(5, 5))
colors = {
    'CORUNDUM': '#48A36D',
    'SPINEL': '#3288BD',
    'HALITE': '#756BB1',
    'BCC_A2': '#E68A00',
}
labels_list = ['Hematite', 'Magnetite', 'Wustite', 'BCC Iron']

plt.plot(filtered_df_FullEquil['lnacr_o'], filtered_df_FullEquil['np(CORUNDUM)'],
         color=colors['CORUNDUM'], label='CORUNDUM')
plt.plot(filtered_df_FullEquil['lnacr_o'], filtered_df_FullEquil['np(SPINEL)'],
         color=colors['SPINEL'], label='SPINEL')
# plt.plot(filtered_df_FullEquil['lnacr_o'], filtered_df_FullEquil['np(HALITE)'],
#          color=colors['HALITE'], label='HALITE')
plt.plot(filtered_df_FullEquil['lnacr_o'], filtered_df_FullEquil['np(BCC_A2)'],
         color=colors['BCC_A2'], label='BCC_A2')

plt.xlabel('Natural log of oxygen activity')
plt.ylabel('Mole fraction')
plt.grid(True)
plt.legend()
# plt.xlim(-100, -25)
plt.show()